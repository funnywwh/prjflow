# 任务与看板系统详细设计文档

## 1. 概述

任务与看板系统是项目管理的核心模块，用于管理项目中的任务、跟踪任务进度、可视化任务状态。系统支持任务创建、更新、状态流转、进度管理、任务依赖关系，以及看板视图和甘特图可视化。

## 2. 功能特性

### 2.1 任务管理

- **任务CRUD**：创建、查看、更新、删除任务
- **任务状态管理**：支持任务状态流转（未开始、进行中、已完成、已暂停、已取消、已关闭）
- **任务优先级管理**：支持低、中、高、紧急四个优先级
- **任务分配**：支持指定任务负责人
- **任务关联**：支持任务关联需求、关联项目
- **任务依赖关系**：支持任务之间的依赖关系（完成到开始、开始到开始、完成到完成、开始到完成）
- **任务进度管理**：支持手动设置进度（0-100%），支持预估工时和实际工时
- **任务时间管理**：支持设置开始日期、结束日期、截止日期
- **Markdown支持**：任务描述支持Markdown格式

### 2.2 看板管理

- **看板CRUD**：创建、查看、更新、删除看板
- **看板列管理**：支持创建、更新、删除看板列，支持列排序
- **任务拖拽**：支持在看板列之间拖拽任务，自动更新任务状态
- **任务筛选**：看板按任务状态自动筛选任务到对应列
- **看板可视化**：看板视图直观展示任务状态和进度

### 2.3 甘特图

- **时间线可视化**：以时间线形式展示任务
- **任务依赖关系可视化**：显示任务之间的依赖关系
- **进度可视化**：显示任务进度条
- **任务筛选**：支持按项目、状态、负责人筛选

### 2.4 项目进度跟踪

- **进度统计**：统计项目整体进度
- **任务统计**：按状态统计任务数量
- **进度报表**：生成项目进度报表

## 3. 数据模型

### 3.1 任务表（tasks）

```go
type Task struct {
    ID        uint           `gorm:"primarykey" json:"id"`
    CreatedAt time.Time      `json:"created_at"`
    UpdatedAt time.Time      `json:"updated_at"`
    DeletedAt gorm.DeletedAt `gorm:"index" json:"-"`

    Title       string `gorm:"size:200;not null" json:"title"`        // 任务标题
    Description string `gorm:"type:text" json:"description"`         // 任务描述（Markdown）
    Status      string `gorm:"size:20;default:'wait'" json:"status"`  // 状态：wait(未开始), doing(进行中), done(已完成), pause(已暂停), cancel(已取消), closed(已关闭)
    Priority    string `gorm:"size:20;default:'medium'" json:"priority"` // 优先级：low, medium, high, urgent

    ProjectID uint    `gorm:"index;not null" json:"project_id"`
    Project   Project `gorm:"foreignKey:ProjectID" json:"project,omitempty"`

    RequirementID *uint       `gorm:"index" json:"requirement_id"`
    Requirement   *Requirement `gorm:"foreignKey:RequirementID" json:"requirement,omitempty"`

    CreatorID uint `gorm:"index" json:"creator_id"`
    Creator   User `gorm:"foreignKey:CreatorID" json:"creator,omitempty"`

    AssigneeID *uint `gorm:"index" json:"assignee_id"`
    Assignee   *User `gorm:"foreignKey:AssigneeID" json:"assignee,omitempty"`

    StartDate *time.Time `json:"start_date"` // 开始日期
    EndDate   *time.Time `json:"end_date"`   // 结束日期
    DueDate   *time.Time `json:"due_date"`   // 截止日期

    Progress int `gorm:"default:0" json:"progress"` // 进度：0-100

    EstimatedHours *float64 `gorm:"default:0" json:"estimated_hours"` // 预估工时（小时）
    ActualHours    *float64 `gorm:"default:0" json:"actual_hours"`    // 实际工时（小时），从资源分配自动计算

    // 任务依赖关系（多对多）
    Dependencies []Task `gorm:"many2many:task_dependencies;joinForeignKey:task_id;joinReferences:dependency_id" json:"dependencies,omitempty"`
}
```

**字段说明：**

- `Title`：任务标题，必填，最大长度200字符
- `Description`：任务描述，支持Markdown格式
- `Status`：任务状态，默认值为"wait"（未开始）
  - `wait`：未开始
  - `doing`：进行中
  - `done`：已完成
  - `pause`：已暂停
  - `cancel`：已取消
  - `closed`：已关闭
- `Priority`：任务优先级，默认值为"medium"（中）
  - `low`：低
  - `medium`：中
  - `high`：高
  - `urgent`：紧急
- `ProjectID`：关联的项目ID，必填
- `RequirementID`：关联的需求ID，可选
- `CreatorID`：创建人ID，必填
- `AssigneeID`：负责人ID，可选
- `StartDate`：开始日期，可选
- `EndDate`：结束日期，可选
- `DueDate`：截止日期，可选
- `Progress`：进度百分比，范围0-100，默认值为0
- `EstimatedHours`：预估工时（小时），可选
- `ActualHours`：实际工时（小时），从资源分配自动计算
- `Dependencies`：任务依赖关系（多对多）

### 3.2 任务依赖关系表（task_dependencies）

```go
type TaskDependency struct {
    TaskID       uint `gorm:"primaryKey" json:"task_id"`
    DependencyID uint `gorm:"primaryKey" json:"dependency_id"`
    Type         string `gorm:"size:20;default:'finish_to_start'" json:"type"` // 依赖类型：finish_to_start, start_to_start, finish_to_finish, start_to_finish
}
```

**字段说明：**

- `TaskID`：任务ID，主键
- `DependencyID`：依赖的任务ID，主键
- `Type`：依赖类型，默认值为"finish_to_start"（完成到开始）
  - `finish_to_start`：前置任务完成后，当前任务才能开始
  - `start_to_start`：前置任务开始时，当前任务才能开始
  - `finish_to_finish`：前置任务完成后，当前任务才能完成
  - `start_to_finish`：前置任务开始时，当前任务才能完成

### 3.3 看板表（boards）

```go
type Board struct {
    ID        uint           `gorm:"primarykey" json:"id"`
    CreatedAt time.Time      `json:"created_at"`
    UpdatedAt time.Time      `json:"updated_at"`
    DeletedAt gorm.DeletedAt `gorm:"index" json:"-"`

    Name        string `gorm:"size:100;not null" json:"name"`        // 看板名称
    Description string `gorm:"type:text" json:"description"`            // 描述

    ProjectID uint    `gorm:"index;not null" json:"project_id"`
    Project   Project `gorm:"foreignKey:ProjectID" json:"project,omitempty"`

    Columns []BoardColumn `gorm:"foreignKey:BoardID" json:"columns,omitempty"`
}
```

**字段说明：**

- `Name`：看板名称，必填，最大长度100字符
- `Description`：看板描述，可选
- `ProjectID`：关联的项目ID，必填
- `Columns`：看板列列表

### 3.4 看板列表（board_columns）

```go
type BoardColumn struct {
    ID        uint           `gorm:"primarykey" json:"id"`
    CreatedAt time.Time      `json:"created_at"`
    UpdatedAt time.Time      `json:"updated_at"`
    DeletedAt gorm.DeletedAt `gorm:"index" json:"-"`

    Name  string `gorm:"size:50;not null" json:"name"`  // 列名称
    Color string `gorm:"size:20" json:"color"`           // 列颜色
    Sort  int    `gorm:"default:0" json:"sort"`          // 排序

    BoardID uint   `gorm:"index;not null" json:"board_id"`
    Board   Board  `gorm:"foreignKey:BoardID" json:"board,omitempty"`

    Status string `gorm:"size:20" json:"status"` // 关联的任务状态
}
```

**字段说明：**

- `Name`：列名称，必填，最大长度50字符
- `Color`：列颜色，可选，用于前端显示
- `Sort`：排序值，默认值为0，数值越小越靠前
- `BoardID`：关联的看板ID，必填
- `Status`：关联的任务状态，可选，用于筛选任务

## 4. API设计

### 4.1 任务管理API

#### 4.1.1 获取任务列表

**接口：** `GET /api/tasks`

**权限：** `task:read`

**查询参数：**

- `keyword`：搜索关键词（标题、描述）
- `project_id`：项目ID
- `status`：任务状态
- `priority`：优先级
- `assignee_id`：负责人ID
- `creator_id`：创建人ID
- `page`：页码，默认1
- `size`：每页数量，默认10

**响应示例：**

```json
{
  "code": 200,
  "message": "success",
  "data": {
    "list": [
      {
        "id": 1,
        "title": "任务标题",
        "description": "任务描述",
        "status": "doing",
        "priority": "high",
        "project_id": 1,
        "project": {
          "id": 1,
          "name": "项目名称"
        },
        "requirement_id": 1,
        "creator_id": 1,
        "assignee_id": 2,
        "start_date": "2024-01-01T00:00:00Z",
        "end_date": "2024-01-31T23:59:59Z",
        "due_date": "2024-01-31T23:59:59Z",
        "progress": 50,
        "estimated_hours": 40.0,
        "actual_hours": 20.0,
        "created_at": "2024-01-01T00:00:00Z",
        "updated_at": "2024-01-15T00:00:00Z"
      }
    ],
    "total": 100,
    "page": 1,
    "page_size": 10
  }
}
```

#### 4.1.2 获取任务详情

**接口：** `GET /api/tasks/:id`

**权限：** `task:read`

**响应示例：**

```json
{
  "code": 200,
  "message": "success",
  "data": {
    "id": 1,
    "title": "任务标题",
    "description": "任务描述",
    "status": "doing",
    "priority": "high",
    "project_id": 1,
    "project": {
      "id": 1,
      "name": "项目名称"
    },
    "requirement_id": 1,
    "requirement": {
      "id": 1,
      "title": "需求标题"
    },
    "creator_id": 1,
    "creator": {
      "id": 1,
      "username": "user1",
      "nickname": "用户1"
    },
    "assignee_id": 2,
    "assignee": {
      "id": 2,
      "username": "user2",
      "nickname": "用户2"
    },
    "start_date": "2024-01-01T00:00:00Z",
    "end_date": "2024-01-31T23:59:59Z",
    "due_date": "2024-01-31T23:59:59Z",
    "progress": 50,
    "estimated_hours": 40.0,
    "actual_hours": 20.0,
    "dependencies": [
      {
        "id": 2,
        "title": "前置任务"
      }
    ],
    "created_at": "2024-01-01T00:00:00Z",
    "updated_at": "2024-01-15T00:00:00Z"
  }
}
```

#### 4.1.3 创建任务

**接口：** `POST /api/tasks`

**权限：** `task:create`

**请求体：**

```json
{
  "title": "任务标题",
  "description": "任务描述（Markdown）",
  "status": "wait",
  "priority": "medium",
  "project_id": 1,
  "requirement_id": 1,
  "assignee_id": 2,
  "start_date": "2024-01-01",
  "end_date": "2024-01-31",
  "due_date": "2024-01-31",
  "estimated_hours": 40.0,
  "dependency_ids": [2, 3]
}
```

**响应示例：**

```json
{
  "code": 200,
  "message": "success",
  "data": {
    "id": 1,
    "title": "任务标题",
    "description": "任务描述（Markdown）",
    "status": "wait",
    "priority": "medium",
    "project_id": 1,
    "requirement_id": 1,
    "assignee_id": 2,
    "start_date": "2024-01-01T00:00:00Z",
    "end_date": "2024-01-31T23:59:59Z",
    "due_date": "2024-01-31T23:59:59Z",
    "progress": 0,
    "estimated_hours": 40.0,
    "actual_hours": 0.0,
    "created_at": "2024-01-01T00:00:00Z",
    "updated_at": "2024-01-01T00:00:00Z"
  }
}
```

#### 4.1.4 更新任务

**接口：** `PUT /api/tasks/:id`

**权限：** `task:update`

**请求体：**

```json
{
  "title": "更新后的任务标题",
  "description": "更新后的任务描述",
  "status": "doing",
  "priority": "high",
  "assignee_id": 3,
  "start_date": "2024-01-02",
  "end_date": "2024-02-01",
  "due_date": "2024-02-01",
  "estimated_hours": 50.0,
  "dependency_ids": [2, 3, 4]
}
```

#### 4.1.5 删除任务

**接口：** `DELETE /api/tasks/:id`

**权限：** `task:delete`

**响应示例：**

```json
{
  "code": 200,
  "message": "删除成功"
}
```

#### 4.1.6 更新任务状态

**接口：** `PUT /api/tasks/:id/status`

**权限：** `task:update`

**请求体：**

```json
{
  "status": "doing"
}
```

#### 4.1.7 更新任务进度

**接口：** `PUT /api/tasks/:id/progress`

**权限：** `task:update`

**请求体：**

```json
{
  "progress": 75,
  "actual_hours": 30.0,
  "date": "2024-01-15"
}
```

**说明：**

- `progress`：进度百分比（0-100）
- `actual_hours`：实际工时（小时），更新时会自动创建资源分配记录
- `date`：工作日期，用于创建资源分配记录

#### 4.1.8 获取任务历史记录

**接口：** `GET /api/tasks/:id/history`

**权限：** `task:read`

**响应示例：**

```json
{
  "code": 200,
  "message": "success",
  "data": [
    {
      "id": 1,
      "task_id": 1,
      "action": "create",
      "field": "",
      "old_value": "",
      "new_value": "",
      "note": "创建任务",
      "user_id": 1,
      "user": {
        "id": 1,
        "username": "user1",
        "nickname": "用户1"
      },
      "created_at": "2024-01-01T00:00:00Z"
    },
    {
      "id": 2,
      "task_id": 1,
      "action": "update",
      "field": "status",
      "old_value": "wait",
      "new_value": "doing",
      "note": "开始执行任务",
      "user_id": 1,
      "user": {
        "id": 1,
        "username": "user1",
        "nickname": "用户1"
      },
      "created_at": "2024-01-02T00:00:00Z"
    }
  ]
}
```

#### 4.1.9 添加任务历史备注

**接口：** `POST /api/tasks/:id/history`

**权限：** `task:update`

**请求体：**

```json
{
  "note": "任务备注"
}
```

### 4.2 看板管理API

#### 4.2.1 获取项目的看板列表

**接口：** `GET /api/projects/:id/boards`

**权限：** `project:read`

**响应示例：**

```json
{
  "code": 200,
  "message": "success",
  "data": [
    {
      "id": 1,
      "name": "开发看板",
      "description": "开发任务看板",
      "project_id": 1,
      "columns": [
        {
          "id": 1,
          "name": "待办",
          "color": "blue",
          "sort": 1,
          "status": "wait"
        },
        {
          "id": 2,
          "name": "进行中",
          "color": "orange",
          "sort": 2,
          "status": "doing"
        },
        {
          "id": 3,
          "name": "已完成",
          "color": "green",
          "sort": 3,
          "status": "done"
        }
      ],
      "created_at": "2024-01-01T00:00:00Z",
      "updated_at": "2024-01-01T00:00:00Z"
    }
  ]
}
```

#### 4.2.2 获取看板详情

**接口：** `GET /api/boards/:id`

**权限：** `project:read`

**响应示例：**

```json
{
  "code": 200,
  "message": "success",
  "data": {
    "id": 1,
    "name": "开发看板",
    "description": "开发任务看板",
    "project_id": 1,
    "project": {
      "id": 1,
      "name": "项目名称"
    },
    "columns": [
      {
        "id": 1,
        "name": "待办",
        "color": "blue",
        "sort": 1,
        "status": "wait"
      },
      {
        "id": 2,
        "name": "进行中",
        "color": "orange",
        "sort": 2,
        "status": "doing"
      },
      {
        "id": 3,
        "name": "已完成",
        "color": "green",
        "sort": 3,
        "status": "done"
      }
    ],
    "created_at": "2024-01-01T00:00:00Z",
    "updated_at": "2024-01-01T00:00:00Z"
  }
}
```

#### 4.2.3 创建看板

**接口：** `POST /api/projects/:id/boards`

**权限：** `project:update`

**请求体：**

```json
{
  "name": "开发看板",
  "description": "开发任务看板",
  "columns": [
    {
      "name": "待办",
      "color": "blue",
      "status": "wait",
      "sort": 1
    },
    {
      "name": "进行中",
      "color": "orange",
      "status": "doing",
      "sort": 2
    },
    {
      "name": "已完成",
      "color": "green",
      "status": "done",
      "sort": 3
    }
  ]
}
```

#### 4.2.4 更新看板

**接口：** `PUT /api/boards/:id`

**权限：** `project:update`

**请求体：**

```json
{
  "name": "更新后的看板名称",
  "description": "更新后的描述",
  "columns": [
    {
      "id": 1,
      "name": "待办",
      "color": "blue",
      "status": "wait",
      "sort": 1
    },
    {
      "id": 2,
      "name": "进行中",
      "color": "orange",
      "status": "doing",
      "sort": 2
    }
  ]
}
```

#### 4.2.5 删除看板

**接口：** `DELETE /api/boards/:id`

**权限：** `project:update`

#### 4.2.6 创建看板列

**接口：** `POST /api/boards/:id/columns`

**权限：** `project:update`

**请求体：**

```json
{
  "name": "新列",
  "color": "purple",
  "status": "pause",
  "sort": 4
}
```

#### 4.2.7 更新看板列

**接口：** `PUT /api/boards/:id/columns/:column_id`

**权限：** `project:update`

**请求体：**

```json
{
  "name": "更新后的列名",
  "color": "red",
  "status": "cancel",
  "sort": 1
}
```

#### 4.2.8 删除看板列

**接口：** `DELETE /api/boards/:id/columns/:column_id`

**权限：** `project:update`

#### 4.2.9 移动任务（拖拽）

**接口：** `PUT /api/boards/:id/move-task`

**权限：** `task:update`

**请求体：**

```json
{
  "task_id": 1,
  "from_column_id": 1,
  "to_column_id": 2,
  "new_status": "doing"
}
```

**说明：**

- 当任务在看板列之间拖拽时，自动更新任务状态为对应列的状态
- 如果目标列没有关联状态，则只更新任务在列中的位置

### 4.3 甘特图API

#### 4.3.1 获取项目甘特图数据

**接口：** `GET /api/projects/:id/gantt`

**权限：** `project:read`

**查询参数：**

- `start_date`：开始日期（可选）
- `end_date`：结束日期（可选）
- `status`：任务状态筛选（可选）
- `assignee_id`：负责人筛选（可选）

**响应示例：**

```json
{
  "code": 200,
  "message": "success",
  "data": {
    "tasks": [
      {
        "id": 1,
        "title": "任务1",
        "start_date": "2024-01-01T00:00:00Z",
        "end_date": "2024-01-15T23:59:59Z",
        "progress": 50,
        "status": "doing",
        "assignee": {
          "id": 1,
          "username": "user1",
          "nickname": "用户1"
        },
        "dependencies": [2]
      },
      {
        "id": 2,
        "title": "任务2",
        "start_date": "2024-01-16T00:00:00Z",
        "end_date": "2024-01-31T23:59:59Z",
        "progress": 0,
        "status": "wait",
        "assignee": {
          "id": 2,
          "username": "user2",
          "nickname": "用户2"
        },
        "dependencies": []
      }
    ],
    "dependencies": [
      {
        "from": 1,
        "to": 2,
        "type": "finish_to_start"
      }
    ]
  }
}
```

### 4.4 项目进度跟踪API

#### 4.4.1 获取项目进度统计

**接口：** `GET /api/projects/:id/progress`

**权限：** `project:read`

**响应示例：**

```json
{
  "code": 200,
  "message": "success",
  "data": {
    "total_tasks": 100,
    "completed_tasks": 50,
    "in_progress_tasks": 30,
    "pending_tasks": 20,
    "overall_progress": 50.0,
    "task_stats_by_status": {
      "wait": 20,
      "doing": 30,
      "done": 50
    },
    "task_stats_by_priority": {
      "low": 10,
      "medium": 50,
      "high": 30,
      "urgent": 10
    }
  }
}
```

## 5. 业务逻辑

### 5.1 任务状态流转

任务状态流转规则：

1. **未开始（wait）** → **进行中（doing）**：任务开始执行
2. **进行中（doing）** → **已完成（done）**：任务完成
3. **进行中（doing）** → **已暂停（pause）**：任务暂停
4. **进行中（doing）** → **已取消（cancel）**：任务取消
5. **已暂停（pause）** → **进行中（doing）**：任务恢复
6. **已完成（done）** → **已关闭（closed）**：任务关闭
7. **已取消（cancel）** → **已关闭（closed）**：任务关闭

**注意：** 状态流转不是强制的，系统允许直接设置任意状态，但建议遵循上述流转规则。

### 5.2 任务进度计算

任务进度可以通过以下方式计算：

1. **手动设置**：用户手动设置进度百分比（0-100）
2. **自动计算**：根据实际工时和预估工时自动计算
   - 计算公式：`progress = (actual_hours / estimated_hours) * 100`
   - 如果 `estimated_hours` 为0或空，则进度保持为手动设置的值
   - 进度范围限制在0-100之间

### 5.3 任务依赖关系

任务依赖关系支持四种类型：

1. **完成到开始（finish_to_start）**：前置任务完成后，当前任务才能开始
2. **开始到开始（start_to_start）**：前置任务开始时，当前任务才能开始
3. **完成到完成（finish_to_finish）**：前置任务完成后，当前任务才能完成
4. **开始到完成（start_to_finish）**：前置任务开始时，当前任务才能完成

**依赖检查：**

- 创建任务时，检查依赖的任务是否存在
- 更新任务状态时，检查依赖的任务是否满足条件
- 删除任务时，检查是否有其他任务依赖当前任务

### 5.4 看板任务筛选

看板列通过 `status` 字段关联任务状态，系统自动筛选对应状态的任务显示在列中：

- 如果列的 `status` 为空，则该列不显示任何任务
- 如果任务的 `status` 与列的 `status` 匹配，则任务显示在该列中
- 一个任务只能显示在一个列中（如果多个列的 `status` 相同，则显示在第一个匹配的列中）

### 5.5 任务拖拽更新状态

当任务在看板列之间拖拽时：

1. 系统自动更新任务的 `status` 为目标列的 `status`
2. 如果目标列的 `status` 为空，则只更新任务在列中的位置，不更新状态
3. 记录任务历史记录，记录状态变更

### 5.6 资源分配自动创建

当更新任务的实际工时时：

1. 系统自动创建或更新资源分配记录（ResourceAllocation）
2. 资源分配记录包含：
   - `resource_id`：资源ID（通过用户ID和项目ID查找或创建）
   - `task_id`：任务ID
   - `project_id`：项目ID
   - `date`：工作日期
   - `hours`：工时（小时）
3. 任务的 `actual_hours` 字段自动从资源分配记录汇总计算

## 6. 权限控制

### 6.1 任务权限

- **task:read**：查看任务列表和详情
- **task:create**：创建任务
- **task:update**：更新任务（包括状态、进度等）
- **task:delete**：删除任务

### 6.2 看板权限

看板权限继承项目权限：

- **project:read**：查看看板列表和详情
- **project:update**：创建、更新、删除看板

### 6.3 数据权限

- 普通用户只能查看和操作自己创建或参与的项目中的任务
- 管理员可以查看和操作所有任务
- 任务创建人、负责人、项目成员可以查看和操作任务

## 7. 前端实现

### 7.1 任务管理页面

- 任务列表：支持筛选、搜索、分页
- 任务详情：显示任务完整信息，支持编辑
- 任务创建/编辑表单：支持所有字段编辑
- 任务状态切换：支持快速切换状态
- 任务进度更新：支持手动设置进度和工时

### 7.2 看板页面

- 看板视图：列式布局，支持拖拽
- 任务卡片：显示任务基本信息
- 看板配置：支持创建、编辑、删除看板和列
- 任务筛选：支持按状态、负责人等筛选

### 7.3 甘特图页面

- 时间线视图：使用ECharts实现甘特图
- 任务依赖关系：显示任务之间的依赖关系
- 任务进度条：显示任务进度
- 任务筛选：支持按项目、状态、负责人筛选

### 7.4 项目进度页面

- 进度统计：显示项目整体进度
- 任务统计：按状态、优先级统计任务
- 进度报表：生成项目进度报表

## 8. 测试用例

### 8.1 任务管理测试

1. **创建任务测试**
   - 测试创建任务成功
   - 测试必填字段验证
   - 测试关联项目和需求
   - 测试任务依赖关系

2. **更新任务测试**
   - 测试更新任务成功
   - 测试状态流转
   - 测试进度更新
   - 测试工时更新和资源分配创建

3. **删除任务测试**
   - 测试删除任务成功
   - 测试删除有依赖关系的任务

4. **任务筛选测试**
   - 测试按项目筛选
   - 测试按状态筛选
   - 测试按负责人筛选
   - 测试搜索功能

### 8.2 看板管理测试

1. **创建看板测试**
   - 测试创建看板成功
   - 测试创建看板列
   - 测试列排序

2. **任务拖拽测试**
   - 测试任务拖拽成功
   - 测试状态自动更新
   - 测试历史记录记录

3. **看板配置测试**
   - 测试更新看板
   - 测试更新看板列
   - 测试删除看板列

### 8.3 甘特图测试

1. **甘特图数据测试**
   - 测试获取甘特图数据成功
   - 测试任务依赖关系显示
   - 测试任务筛选

### 8.4 项目进度测试

1. **进度统计测试**
   - 测试进度统计准确性
   - 测试任务状态统计
   - 测试优先级统计

## 9. 注意事项

1. **任务依赖关系**：避免循环依赖，系统应检查并阻止循环依赖的创建
2. **任务状态一致性**：确保任务状态与看板列状态一致
3. **资源分配**：更新工时时确保资源分配记录正确创建
4. **权限控制**：确保用户只能访问有权限的项目和任务
5. **数据完整性**：删除任务时检查依赖关系，删除看板时检查关联的任务
6. **性能优化**：任务列表查询时使用预加载（Preload）避免N+1问题
7. **Markdown渲染**：前端正确渲染任务描述的Markdown内容

## 10. 未来优化

1. **任务模板**：支持创建任务模板，快速创建相似任务
2. **任务标签**：支持为任务添加标签，方便分类和筛选
3. **任务评论**：支持任务评论功能，方便团队协作
4. **任务附件**：支持为任务添加附件
5. **任务提醒**：支持任务截止日期提醒
6. **看板自定义**：支持更多看板视图样式
7. **甘特图优化**：支持更多甘特图交互功能
8. **进度报表**：支持导出项目进度报表

