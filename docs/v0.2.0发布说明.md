# v0.2.0 发布说明

## 版本信息

- **版本号**: v0.2.0
- **发布日期**: 2025年11月
- **主要更新**: 微信账号绑定、附件管理、工作报告优化

---

## 🎉 新功能

### 1. 微信账号绑定功能

允许已登录用户将自己的账号绑定到微信，绑定后可以使用微信扫码登录。

**功能特性**：
- ✅ 获取微信绑定二维码（支持PC端扫码）
- ✅ 微信绑定回调处理（自动识别用户身份）
- ✅ 微信解绑功能
- ✅ WebSocket实时通知绑定状态
- ✅ 绑定状态显示（用户信息页面）

**使用场景**：
- 用户首次登录后，可以绑定微信账号
- 绑定后可以使用微信扫码快速登录
- 支持解绑和重新绑定

**API接口**：
- `GET /api/auth/wechat/bind/qrcode` - 获取绑定二维码
- `GET /api/auth/wechat/bind/callback` - 处理绑定回调
- `POST /api/auth/wechat/unbind` - 解绑微信

### 2. 附件管理功能

支持文件上传、下载和关联实体（需求、Bug、任务等）。

**功能特性**：
- ✅ 文件上传（支持多种文件类型）
- ✅ 文件下载
- ✅ 附件关联实体（需求、Bug、任务等）
- ✅ 附件列表管理
- ✅ 文件存储管理

**使用场景**：
- 在需求、Bug、任务中上传相关文档
- 管理项目相关文件
- 下载和查看附件

### 3. 工作报告功能优化

优化日报和周报功能，提升用户体验。

**功能特性**：
- ✅ 工作内容支持Markdown渲染
- ✅ 工作内容限制2行显示（列表页）
- ✅ 提交按钮改为"提交"并自动设置状态为已提交
- ✅ 工作汇总包含用户创建的Bug
- ✅ 优化审批流程和状态显示

**改进点**：
- 工作内容展示更美观（Markdown渲染）
- 审批流程更清晰（显示所有审批人状态）
- 工作汇总更全面（包含Bug信息）

---

## 🔧 功能优化

### 1. 系统初始化流程优化

- ✅ 微信配置移至系统管理菜单
- ✅ 初始化页面直接显示微信配置表单
- ✅ 配置完成后显示扫码登录
- ✅ 添加微信AppID和AppSecret格式验证
- ✅ 创建可选认证中间件，支持初始化阶段访问微信配置API
- ✅ 优化路由守卫，系统未初始化时自动跳转到初始化页面

### 2. 权限管理优化

- ✅ 添加测试单权限（test-case:create、test-case:update、test-case:delete）
- ✅ 优化角色权限配置
- ✅ 项目创建者自动加入项目成员
- ✅ 用户管理部门树形选择优化

### 3. 部门管理优化

- ✅ 优化部门树形结构显示
- ✅ 修复重复显示问题
- ✅ 直接使用树形数据，提升性能

### 4. 菜单管理优化

- ✅ 修复菜单排序问题
- ✅ 创建默认角色并分配权限

---

## 🐛 问题修复

- ✅ 修复部门管理重复显示问题
- ✅ 修复菜单排序问题
- ✅ 修复工作报告审批数量计算问题
- ✅ 修复工作汇总查询逻辑
- ✅ 优化审批人选择（过滤当前用户自己）

---

## 📝 技术改进

### 后端

- ✅ 微信绑定回调流程重构
- ✅ 附件上传功能实现
- ✅ 工作报告API优化
- ✅ 数据库迁移优化

### 前端

- ✅ 微信绑定UI组件（WeChatQRCode组件）
- ✅ 附件管理页面
- ✅ 工作报告页面优化（Markdown渲染）
- ✅ 系统初始化流程优化

---

## 📚 文档更新

- ✅ 添加微信绑定功能设计文档
- ✅ 更新API设计文档
- ✅ 更新权限管理设计文档
- ✅ 更新开发计划文档

---

## 🔄 数据库变更

- ✅ User表：wechat_open_id字段（已存在，无需修改）
- ✅ 附件相关表结构
- ✅ 工作报告表结构优化

---

## ⚠️ 升级说明

### 从 v0.1.0 升级到 v0.2.0

1. **数据库迁移**：
   - 系统启动时会自动执行数据库迁移
   - 无需手动操作

2. **配置更新**：
   - 微信配置已移至系统管理菜单
   - 首次访问系统会自动跳转到初始化页面

3. **功能使用**：
   - 微信绑定功能需要用户已登录
   - 附件上传功能需要在相关页面使用
   - 工作报告功能已优化，使用方式保持不变

---

## 🎯 下一步计划

- ⏳ 单元测试补充（各模块测试覆盖率提升至100%）
- ⏳ 插件管理系统开发
- ⏳ 关系图生成功能
- ⏳ 更多功能优化和性能提升

---

## 🙏 致谢

感谢所有贡献者和用户的支持！

---

**文档版本**: v0.2.0  
**最后更新**: 2025年11月  
**维护者**: 开发团队

